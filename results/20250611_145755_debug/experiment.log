INFO:root:Starting the logger.
INFO:root:##########1 out of 1 datasets: feynman_III_10_19##########
INFO:root:Time: 20250611_145756
INFO:root:Feature shape: (100000, 4), target shape: (100000,)
INFO:root:###1 out of 1 Hyperparameter combinations ###
INFO:root:Training parameters: {'validation': True, 'normalization': False, 'time_limit': 480, 'evaluations_limit': 1000000, 'max_dataset_length': 500, 'model': 'ParFamTorch', 'target_noise': 0.0, 'feature_noise': 0.0, 'seed': 1234, 'bayesian_hp_optimization': False, 'bayesian_opt_n_calls': 500, 'maxiter1': 100, 'maxiter2': 0, 'optimizer': 'basinhopping', 'pruning_iterations': 1, 'pruning_cut_off': 0.01, 'classifier': None, 'local_minimizer': 'BFGS', 'maxiter_per_dim_local_minimizer': 100, 'lambda_1': 0.001, 'repetitions': 1, 'parallel': False, 'n_processes': 4, 'lambda_1_cut': 0, 'lambda_1_piecewise': 0.0, 'device': 'cpu', 'accuracy': 0.0001, 'iterative_finetuning': True, 'max_n_active_parameters': 10, 'lambda_1_finetuning': 1e-05, 'path_pretrained': 'Flexible dimension/full_19_big_training_sets/20240427_070711_5M/Datetime_20240427_070717_Loss_training_set_size_797545_batch_size_341_hidden_dim_256.pt', 'topk_predictions': 3, 'enforce_function_iterate': 'Both', 'procs': 6, 'populations': 6, 'population_size': 50, 'ncycles_per_iteration': 500, 'max_size': 50, 'max_depth': 10, 'accuracy_udsr': 1e-06, 'iterations_udsr': 10000000, 'generations_udsr': 20, 'population_size_udsr': 100, 'aif_nn_epochs': 400, 'bf_try_time': 30, 'bf_ops_file_type': '19ops', 'polyfit_deg': 4, 'max_input_points': 200, 'max_number_bags': 100, 'n_trees_to_refine': 10, 'steps_kan': 30, 'normalization_kan': False, 'max_width_length_kan': 1, 'max_depth_kan': 0}
INFO:root:Sequential computation
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 3, 'degree_output_denominator': 0, 'degree_input_denominator': 0, 'function_names': [], 'width': 1, 'functions': [], 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 35
INFO:root:Number parameters active: 35
INFO:root:Number of evaluations: 1942
INFO:root:Relative l2 distance train: 0.006554063873208448
INFO:root:Relative l2 distance validation: 0.007209196251023319
INFO:root:Training time: 2.6563894748687744
INFO:root:Cumulative training time: 2.7208633422851562
INFO:root:Cumulative number of evaluations: 1942
INFO:root:New best relative l2 distance validation: 0.007209196251023319
INFO:root:Model parameters: {'degree_input_polynomials': 1, 'degree_output_polynomials': 1, 'functions': ['sqrt'], 'function_names': ['sqrt'], 'width': 1, 'degree_input_denominator': 0, 'degree_output_denominator': 0, 'degree_output_polynomials_specific': [1], 'degree_output_polynomials_denominator_specific': [1], 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 11
INFO:root:Number parameters active: 11
INFO:root:Number of evaluations: 1059
INFO:root:Relative l2 distance train: 0.18895908115721033
INFO:root:Relative l2 distance validation: 0.18702423016505051
INFO:root:Training time: 0.8968539237976074
INFO:root:Cumulative training time: 3.6712398529052734
INFO:root:Cumulative number of evaluations: 3001
INFO:root:Model parameters: {'degree_input_polynomials': 1, 'degree_output_polynomials': 1, 'functions': ['sqrt'], 'function_names': ['sqrt'], 'width': 1, 'degree_input_denominator': 0, 'degree_output_denominator': 0, 'degree_output_polynomials_specific': [1], 'degree_output_polynomials_denominator_specific': [1], 'enforce_function': True, 'maximal_potence': 3}
INFO:root:Number parameters: 6
INFO:root:Number parameters active: 6
INFO:root:Number of evaluations: 645
INFO:root:Relative l2 distance train: 0.3612001762148827
INFO:root:Relative l2 distance validation: 0.36589938326671667
INFO:root:Training time: 0.2693641185760498
INFO:root:Cumulative training time: 3.9959428310394287
INFO:root:Cumulative number of evaluations: 3646
INFO:root:Model parameters: {'degree_input_polynomials': 2, 'degree_output_polynomials': 1, 'functions': ['sqrt'], 'function_names': ['sqrt'], 'width': 1, 'degree_input_denominator': 0, 'degree_output_denominator': 0, 'degree_output_polynomials_specific': [1], 'degree_output_polynomials_denominator_specific': [1], 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 21
INFO:root:Number parameters active: 21
INFO:root:Number of evaluations: 2283
INFO:root:Relative l2 distance train: 0.05390622106497571
INFO:root:Relative l2 distance validation: 0.061016223466752985
INFO:root:Training time: 1.1704659461975098
INFO:root:Cumulative training time: 5.2202064990997314
INFO:root:Cumulative number of evaluations: 5929
INFO:root:Model parameters: {'degree_input_polynomials': 2, 'degree_output_polynomials': 1, 'functions': ['sqrt'], 'function_names': ['sqrt'], 'width': 1, 'degree_input_denominator': 0, 'degree_output_denominator': 0, 'degree_output_polynomials_specific': [1], 'degree_output_polynomials_denominator_specific': [1], 'enforce_function': True, 'maximal_potence': 3}
INFO:root:Number parameters: 16
INFO:root:Number parameters active: 16
INFO:root:Number of evaluations: 1812
INFO:root:Relative l2 distance train: 0.9457149541751547
INFO:root:Relative l2 distance validation: 0.9683913416823106
INFO:root:Training time: 0.8066596984863281
INFO:root:Cumulative training time: 6.079035997390747
INFO:root:Cumulative number of evaluations: 7741
INFO:root:Model parameters: {'degree_input_polynomials': 1, 'degree_output_polynomials': 2, 'functions': ['sqrt'], 'function_names': ['sqrt'], 'width': 1, 'degree_input_denominator': 0, 'degree_output_denominator': 0, 'degree_output_polynomials_specific': [1], 'degree_output_polynomials_denominator_specific': [1], 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 25
INFO:root:Number parameters active: 25
INFO:root:Number of evaluations: 1344
INFO:root:Relative l2 distance train: 0.03060314281753419
INFO:root:Relative l2 distance validation: 0.03461347714429123
INFO:root:Training time: 1.2795383930206299
INFO:root:Cumulative training time: 7.412283658981323
INFO:root:Cumulative number of evaluations: 9085
INFO:root:Model parameters: {'degree_input_polynomials': 1, 'degree_output_polynomials': 2, 'functions': ['sqrt'], 'function_names': ['sqrt'], 'width': 1, 'degree_input_denominator': 0, 'degree_output_denominator': 0, 'degree_output_polynomials_specific': [1], 'degree_output_polynomials_denominator_specific': [1], 'enforce_function': True, 'maximal_potence': 3}
INFO:root:Number parameters: 10
INFO:root:Number parameters active: 10
INFO:root:Number of evaluations: 1204
INFO:root:Relative l2 distance train: 0.08490244147970381
INFO:root:Relative l2 distance validation: 0.08589200564983979
INFO:root:Training time: 0.8164772987365723
INFO:root:Cumulative training time: 8.281344175338745
INFO:root:Cumulative number of evaluations: 10289
INFO:root:Model parameters: {'degree_input_polynomials': 2, 'degree_output_polynomials': 2, 'functions': ['sqrt'], 'function_names': ['sqrt'], 'width': 1, 'degree_input_denominator': 0, 'degree_output_denominator': 0, 'degree_output_polynomials_specific': [1], 'degree_output_polynomials_denominator_specific': [1], 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 35
INFO:root:Number parameters active: 35
INFO:root:Number of evaluations: 2780
INFO:root:Relative l2 distance train: 0.02065005235712065
INFO:root:Relative l2 distance validation: 0.023528514968387655
INFO:root:Training time: 2.7239184379577637
INFO:root:Cumulative training time: 11.060668706893921
INFO:root:Cumulative number of evaluations: 13069
INFO:root:Model parameters: {'degree_input_polynomials': 2, 'degree_output_polynomials': 2, 'functions': ['sqrt'], 'function_names': ['sqrt'], 'width': 1, 'degree_input_denominator': 0, 'degree_output_denominator': 0, 'degree_output_polynomials_specific': [1], 'degree_output_polynomials_denominator_specific': [1], 'enforce_function': True, 'maximal_potence': 3}
INFO:root:Number parameters: 20
INFO:root:Number parameters active: 20
INFO:root:Number of evaluations: 4795
INFO:root:Relative l2 distance train: 0.025812109249454703
INFO:root:Relative l2 distance validation: 0.0282003183546027
INFO:root:Training time: 3.532547950744629
INFO:root:Cumulative training time: 14.647525072097778
INFO:root:Cumulative number of evaluations: 17864
INFO:root:Model parameters: {'degree_input_polynomials': 1, 'degree_output_polynomials': 3, 'functions': ['sqrt'], 'function_names': ['sqrt'], 'width': 1, 'degree_input_denominator': 0, 'degree_output_denominator': 0, 'degree_output_polynomials_specific': [1], 'degree_output_polynomials_denominator_specific': [1], 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 55
INFO:root:Number parameters active: 55
INFO:root:Number of evaluations: 2830
INFO:root:Relative l2 distance train: 0.007183164230860338
INFO:root:Relative l2 distance validation: 0.007244744704248338
INFO:root:Training time: 8.02731442451477
INFO:root:Cumulative training time: 22.73944878578186
INFO:root:Cumulative number of evaluations: 20694
INFO:root:Model parameters: {'degree_input_polynomials': 1, 'degree_output_polynomials': 3, 'functions': ['sqrt'], 'function_names': ['sqrt'], 'width': 1, 'degree_input_denominator': 0, 'degree_output_denominator': 0, 'degree_output_polynomials_specific': [1], 'degree_output_polynomials_denominator_specific': [1], 'enforce_function': True, 'maximal_potence': 3}
INFO:root:Number parameters: 20
INFO:root:Number parameters active: 20
INFO:root:Number of evaluations: 1594
INFO:root:Relative l2 distance train: 0.08078919249152433
INFO:root:Relative l2 distance validation: 0.09567361155613502
INFO:root:Training time: 2.1948862075805664
INFO:root:Cumulative training time: 24.988960027694702
INFO:root:Cumulative number of evaluations: 22288
INFO:root:Model parameters: {'degree_input_polynomials': 2, 'degree_output_polynomials': 3, 'functions': ['sqrt'], 'function_names': ['sqrt'], 'width': 1, 'degree_input_denominator': 0, 'degree_output_denominator': 0, 'degree_output_polynomials_specific': [1], 'degree_output_polynomials_denominator_specific': [1], 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 65
INFO:root:Number parameters active: 65
INFO:root:Number of evaluations: 3661
INFO:root:Relative l2 distance train: 9.880419749324912e-05
INFO:root:Relative l2 distance validation: 0.00011305456101096264
INFO:root:Training time: 10.898510932922363
INFO:root:Cumulative training time: 35.94992232322693
INFO:root:Cumulative number of evaluations: 25949
INFO:root:New best relative l2 distance validation: 0.00011305456101096264
INFO:root:Model parameters: {'degree_input_polynomials': 2, 'degree_output_polynomials': 3, 'functions': ['sqrt'], 'function_names': ['sqrt'], 'width': 1, 'degree_input_denominator': 0, 'degree_output_denominator': 0, 'degree_output_polynomials_specific': [1], 'degree_output_polynomials_denominator_specific': [1], 'enforce_function': True, 'maximal_potence': 3}
INFO:root:Number parameters: 30
INFO:root:Number parameters active: 30
INFO:root:Number of evaluations: 2235
INFO:root:Relative l2 distance train: 0.5603584001289881
INFO:root:Relative l2 distance validation: 0.6785978735227775
INFO:root:Training time: 3.1396965980529785
INFO:root:Cumulative training time: 39.148244857788086
INFO:root:Cumulative number of evaluations: 28184
INFO:root:Time for multiprocessing in total: 39.152458906173706
INFO:root:Best distance (train, val, test): (tensor(9.8804e-05, dtype=torch.float64), tensor(0.0001, dtype=torch.float64), tensor(0.0001, dtype=torch.float64))
INFO:root:Best formula: 0.001*x0**2*sqrt(Abs(0.001*x0*x2 + 0.967*x1**2 + 0.01*x1*x2 + 0.035*x1*x3 + 0.004*x1 + 0.94*x2**2 + 0.001*x2*x3 + 0.961*x3**2)) - 0.014*x0*x1**2 - 0.006*x0*x1*x2 - 0.009*x0*x1*x3 + 0.014*x0*x1*sqrt(Abs(0.001*x0*x2 + 0.967*x1**2 + 0.01*x1*x2 + 0.035*x1*x3 + 0.004*x1 + 0.94*x2**2 + 0.001*x2*x3 + 0.961*x3**2)) - 0.022*x0*x1 - 0.011*x0*x2**2 - 0.005*x0*x2*x3 + 0.009*x0*x2*sqrt(Abs(0.001*x0*x2 + 0.967*x1**2 + 0.01*x1*x2 + 0.035*x1*x3 + 0.004*x1 + 0.94*x2**2 + 0.001*x2*x3 + 0.961*x3**2)) - 0.013*x0*x3**2 + 0.011*x0*x3*sqrt(Abs(0.001*x0*x2 + 0.967*x1**2 + 0.01*x1*x2 + 0.035*x1*x3 + 0.004*x1 + 0.94*x2**2 + 0.001*x2*x3 + 0.961*x3**2)) - 0.015*x0*x3 + 1.036*x0*sqrt(Abs(0.001*x0*x2 + 0.967*x1**2 + 0.01*x1*x2 + 0.035*x1*x3 + 0.004*x1 + 0.94*x2**2 + 0.001*x2*x3 + 0.961*x3**2)) - 0.002*x0 - 0.008*x1**3 - 0.013*x1**2*x2 + 0.008*x1**2*sqrt(Abs(0.001*x0*x2 + 0.967*x1**2 + 0.01*x1*x2 + 0.035*x1*x3 + 0.004*x1 + 0.94*x2**2 + 0.001*x2*x3 + 0.961*x3**2)) - 0.011*x1*x2**2 - 0.002*x1*x2*x3 + 0.011*x1*x2*sqrt(Abs(0.001*x0*x2 + 0.967*x1**2 + 0.01*x1*x2 + 0.035*x1*x3 + 0.004*x1 + 0.94*x2**2 + 0.001*x2*x3 + 0.961*x3**2)) - 0.004*x1*x3**2 - 0.001*x1*x3 + 0.002*x1 - 0.012*x2**3 - 0.003*x2**2*x3 + 0.013*x2**2*sqrt(Abs(0.001*x0*x2 + 0.967*x1**2 + 0.01*x1*x2 + 0.035*x1*x3 + 0.004*x1 + 0.94*x2**2 + 0.001*x2*x3 + 0.961*x3**2)) - 0.009*x2*x3**2 + 0.004*x2*x3*sqrt(Abs(0.001*x0*x2 + 0.967*x1**2 + 0.01*x1*x2 + 0.035*x1*x3 + 0.004*x1 + 0.94*x2**2 + 0.001*x2*x3 + 0.961*x3**2)) + 0.002*x2 + 0.002*x3**3 - 0.003*x3 best training time: 10.898510932922363
INFO:root:Target formula: mom*sqrt(Bx**2+By**2+Bz**2)
INFO:root:Estimated formula: 0.001*x0**2*sqrt(Abs(0.001*x0*x2 + 0.967*x1**2 + 0.01*x1*x2 + 0.035*x1*x3 + 0.004*x1 + 0.94*x2**2 + 0.001*x2*x3 + 0.961*x3**2)) - 0.014*x0*x1**2 - 0.006*x0*x1*x2 - 0.009*x0*x1*x3 + 0.014*x0*x1*sqrt(Abs(0.001*x0*x2 + 0.967*x1**2 + 0.01*x1*x2 + 0.035*x1*x3 + 0.004*x1 + 0.94*x2**2 + 0.001*x2*x3 + 0.961*x3**2)) - 0.022*x0*x1 - 0.011*x0*x2**2 - 0.005*x0*x2*x3 + 0.009*x0*x2*sqrt(Abs(0.001*x0*x2 + 0.967*x1**2 + 0.01*x1*x2 + 0.035*x1*x3 + 0.004*x1 + 0.94*x2**2 + 0.001*x2*x3 + 0.961*x3**2)) - 0.013*x0*x3**2 + 0.011*x0*x3*sqrt(Abs(0.001*x0*x2 + 0.967*x1**2 + 0.01*x1*x2 + 0.035*x1*x3 + 0.004*x1 + 0.94*x2**2 + 0.001*x2*x3 + 0.961*x3**2)) - 0.015*x0*x3 + 1.036*x0*sqrt(Abs(0.001*x0*x2 + 0.967*x1**2 + 0.01*x1*x2 + 0.035*x1*x3 + 0.004*x1 + 0.94*x2**2 + 0.001*x2*x3 + 0.961*x3**2)) - 0.002*x0 - 0.008*x1**3 - 0.013*x1**2*x2 + 0.008*x1**2*sqrt(Abs(0.001*x0*x2 + 0.967*x1**2 + 0.01*x1*x2 + 0.035*x1*x3 + 0.004*x1 + 0.94*x2**2 + 0.001*x2*x3 + 0.961*x3**2)) - 0.011*x1*x2**2 - 0.002*x1*x2*x3 + 0.011*x1*x2*sqrt(Abs(0.001*x0*x2 + 0.967*x1**2 + 0.01*x1*x2 + 0.035*x1*x3 + 0.004*x1 + 0.94*x2**2 + 0.001*x2*x3 + 0.961*x3**2)) - 0.004*x1*x3**2 - 0.001*x1*x3 + 0.002*x1 - 0.012*x2**3 - 0.003*x2**2*x3 + 0.013*x2**2*sqrt(Abs(0.001*x0*x2 + 0.967*x1**2 + 0.01*x1*x2 + 0.035*x1*x3 + 0.004*x1 + 0.94*x2**2 + 0.001*x2*x3 + 0.961*x3**2)) - 0.009*x2*x3**2 + 0.004*x2*x3*sqrt(Abs(0.001*x0*x2 + 0.967*x1**2 + 0.01*x1*x2 + 0.035*x1*x3 + 0.004*x1 + 0.94*x2**2 + 0.001*x2*x3 + 0.961*x3**2)) + 0.002*x2 + 0.002*x3**3 - 0.003*x3, Training time: 39.152458906173706
INFO:root:Relative L2 distance train: 9.880419749324912e-05, validation: 0.00011305456101096264
INFO:root:R squared validation: 0.999999987548058
INFO:root:Number of active coefficients: 65
INFO:root:Number of evaluations in total: 28184
INFO:root:Finished the experiment on 20250611_145912
