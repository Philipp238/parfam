INFO:root:Starting the logger.
INFO:root:##########1 out of 3 datasets: feynman_III_10_19##########
INFO:root:Time: 20240522_165549
INFO:root:Feature shape: (100000, 4), target shape: (100000,)
INFO:root:###1 out of 1 Hyperparameter combinations ###
INFO:root:Training parameters: {'normalization': False, 'time_limit': 48, 'evaluations_limit': 1000000, 'max_dataset_length': 500, 'model': 'ParFamTorch', 'target_noise': 0.0, 'feature_noise': 0.0, 'seed': 12345, 'accuracy': 0.0001, 'maxiter1': 10, 'maxiter2': 0, 'optimizer': 'basinhopping', 'pruning_iterations': 1, 'pruning_cut_off': 0.01, 'classifier': None, 'local_minimizer': 'BFGS', 'maxiter_per_dim_local_minimizer': 100, 'lambda_1': 0.001, 'repetitions': 1, 'parallel': False, 'n_processes': 4, 'lambda_1_cut': 0, 'lambda_1_piecewise': 0, 'device': 'cpu', 'iterative_finetuning': True, 'max_n_active_parameters': 10, 'lambda_1_finetuning': 1e-05, 'path_pretrained': 'Flexible dimension/full_19_big_training_sets/20240427_070711_5M/Datetime_20240427_070717_Loss_training_set_size_797545_batch_size_341_hidden_dim_256.pt', 'topk_predictions': 10, 'enforce_function_iterate': 'False', 'procs': 6, 'populations': 6, 'population_size': 50, 'ncycles_per_iteration': 500, 'max_size': 50, 'max_depth': 10, 'iterations_udsr': 50000, 'accuracy_udsr': 1e-08, 'aif_nn_epochs': 60, 'bf_try_time': 4, 'bf_ops_file_type': '10ops', 'polyfit_deg': 3, 'max_input_points': 200, 'max_number_bags': 100, 'n_trees_to_refine': 100}
INFO:root:Sequential computation
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 4, 'degree_output_denominator': 0, 'degree_input_denominator': 0, 'function_names': [], 'width': 1, 'functions': [], 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 66
INFO:root:Number parameters active: 66
INFO:root:Number of evaluations: 656
INFO:root:Relative l2 distance train: 0.002366310553897984
INFO:root:Relative l2 distance validation: 0.003208246819619078
INFO:root:Training time: 0.415698766708374
INFO:root:Cumulative training time: 0.5512270927429199
INFO:root:Cumulative number of evaluations: 656
INFO:root:New best relative l2 distance validation: 0.003208246819619078
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 1, 'degree_output_denominator': 1, 'degree_input_denominator': 0, 'functions': [], 'function_names': [], 'width': 1, 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 10
INFO:root:Number parameters active: 10
INFO:root:Number of evaluations: 709
INFO:root:Relative l2 distance train: 0.14302200397052453
INFO:root:Relative l2 distance validation: 0.14795758723392227
INFO:root:Training time: 0.3199758529663086
INFO:root:Cumulative training time: 0.9416365623474121
INFO:root:Cumulative number of evaluations: 1365
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 2, 'degree_output_denominator': 1, 'degree_input_denominator': 0, 'functions': [], 'function_names': [], 'width': 1, 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 20
INFO:root:Number parameters active: 20
INFO:root:Number of evaluations: 1009
INFO:root:Relative l2 distance train: 0.20318950802462946
INFO:root:Relative l2 distance validation: 2.6258747080992215
INFO:root:Training time: 0.5226740837097168
INFO:root:Cumulative training time: 1.5331168174743652
INFO:root:Cumulative number of evaluations: 2374
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 3, 'degree_output_denominator': 1, 'degree_input_denominator': 0, 'functions': [], 'function_names': [], 'width': 1, 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 40
INFO:root:Number parameters active: 40
INFO:root:Number of evaluations: 564
INFO:root:Relative l2 distance train: 0.0024362207574755287
INFO:root:Relative l2 distance validation: 0.0030168760184903945
INFO:root:Training time: 0.3298306465148926
INFO:root:Cumulative training time: 1.9808707237243652
INFO:root:Cumulative number of evaluations: 2938
INFO:root:New best relative l2 distance validation: 0.0030168760184903945
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 4, 'degree_output_denominator': 1, 'degree_input_denominator': 0, 'functions': [], 'function_names': [], 'width': 1, 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 71
INFO:root:Number parameters active: 71
INFO:root:Number of evaluations: 807
INFO:root:Relative l2 distance train: 0.0011400304933497291
INFO:root:Relative l2 distance validation: 0.0017503016843826121
INFO:root:Training time: 0.6021335124969482
INFO:root:Cumulative training time: 2.671959161758423
INFO:root:Cumulative number of evaluations: 3745
INFO:root:New best relative l2 distance validation: 0.0017503016843826121
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 1, 'degree_output_denominator': 2, 'degree_input_denominator': 0, 'functions': [], 'function_names': [], 'width': 1, 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 20
INFO:root:Number parameters active: 20
INFO:root:Number of evaluations: 1046
INFO:root:Relative l2 distance train: 0.16215922574333583
INFO:root:Relative l2 distance validation: 0.9907101049686038
INFO:root:Training time: 0.5266194343566895
INFO:root:Cumulative training time: 3.2677576541900635
INFO:root:Cumulative number of evaluations: 4791
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 2, 'degree_output_denominator': 2, 'degree_input_denominator': 0, 'functions': [], 'function_names': [], 'width': 1, 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 30
INFO:root:Number parameters active: 30
INFO:root:Number of evaluations: 893
INFO:root:Relative l2 distance train: 0.11806890894079873
INFO:root:Relative l2 distance validation: 3.3651349575214082
INFO:root:Training time: 0.4731161594390869
INFO:root:Cumulative training time: 3.851865768432617
INFO:root:Cumulative number of evaluations: 5684
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 3, 'degree_output_denominator': 2, 'degree_input_denominator': 0, 'functions': [], 'function_names': [], 'width': 1, 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 50
INFO:root:Number parameters active: 50
INFO:root:Number of evaluations: 1026
INFO:root:Relative l2 distance train: 0.025620852937726972
INFO:root:Relative l2 distance validation: 0.026286451360717274
INFO:root:Training time: 0.6464922428131104
INFO:root:Cumulative training time: 4.57654070854187
INFO:root:Cumulative number of evaluations: 6710
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 4, 'degree_output_denominator': 2, 'degree_input_denominator': 0, 'functions': [], 'function_names': [], 'width': 1, 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 81
INFO:root:Number parameters active: 81
INFO:root:Number of evaluations: 692
INFO:root:Relative l2 distance train: 0.004285922201828185
INFO:root:Relative l2 distance validation: 0.05458106375469093
INFO:root:Training time: 0.557915210723877
INFO:root:Cumulative training time: 5.227409362792969
INFO:root:Cumulative number of evaluations: 7402
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 1, 'degree_output_denominator': 3, 'degree_input_denominator': 0, 'functions': [], 'function_names': [], 'width': 1, 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 40
INFO:root:Number parameters active: 40
INFO:root:Number of evaluations: 976
INFO:root:Relative l2 distance train: 0.04439655538651319
INFO:root:Relative l2 distance validation: 0.049912296468430276
INFO:root:Training time: 0.5675907135009766
INFO:root:Cumulative training time: 5.911060094833374
INFO:root:Cumulative number of evaluations: 8378
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 2, 'degree_output_denominator': 3, 'degree_input_denominator': 0, 'functions': [], 'function_names': [], 'width': 1, 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 50
INFO:root:Number parameters active: 50
INFO:root:Number of evaluations: 1180
INFO:root:Relative l2 distance train: 0.04775376470923501
INFO:root:Relative l2 distance validation: 0.39556128992367484
INFO:root:Training time: 0.7305898666381836
INFO:root:Cumulative training time: 6.720529317855835
INFO:root:Cumulative number of evaluations: 9558
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 3, 'degree_output_denominator': 3, 'degree_input_denominator': 0, 'functions': [], 'function_names': [], 'width': 1, 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 70
INFO:root:Number parameters active: 70
INFO:root:Number of evaluations: 856
INFO:root:Relative l2 distance train: 0.0010506581824987885
INFO:root:Relative l2 distance validation: 0.0012990700086835873
INFO:root:Training time: 0.6618139743804932
INFO:root:Cumulative training time: 7.472166061401367
INFO:root:Cumulative number of evaluations: 10414
INFO:root:New best relative l2 distance validation: 0.0012990700086835873
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 4, 'degree_output_denominator': 3, 'degree_input_denominator': 0, 'functions': [], 'function_names': [], 'width': 1, 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 101
INFO:root:Number parameters active: 101
INFO:root:Number of evaluations: 950
INFO:root:Relative l2 distance train: 0.008334800591409635
INFO:root:Relative l2 distance validation: 0.41875194032335666
INFO:root:Training time: 1.04435396194458
INFO:root:Cumulative training time: 8.625676155090332
INFO:root:Cumulative number of evaluations: 11364
INFO:root:Time for multiprocessing in total: 8.6303551197052
INFO:root:Finetuning with this cut off would not change anything.
INFO:root:Best distance (train, val, test): (tensor(0.0011, dtype=torch.float64), tensor(0.0013, dtype=torch.float64), tensor(0.0013, dtype=torch.float64))
INFO:root:Best formula: (0.004*x0**3 + 0.001*x0**2*x2 + 0.019*x0**2 + 0.748*x0*x1**2 + 0.194*x0*x1*x2 + 0.268*x0*x1*x3 + 0.004*x0*x1 + 0.754*x0*x2**2 + 0.307*x0*x2*x3 + 0.777*x0*x3**2 + 0.001*x1**2*x2 + 0.004*x1**2*x3 + 0.001*x1*x3 + 0.002*x2**2*x3 + 0.003*x3**3 + 0.001*x3**2)/(-0.001*x0**3 + 0.001*x0**2*x3 + 0.009*x0**2 - 0.007*x0*x1 - 0.003*x0*x2 - 0.011*x0*x3 + 0.008*x0 - 0.002*x1**3 - 0.002*x1**2*x3 + 0.043*x1**2 + 0.001*x1*x2**2 + 0.006*x1*x2*x3 - 0.047*x1*x2 + 0.001*x1*x3**2 - 0.031*x1*x3 + 0.544*x1 - 0.002*x2**3 - 0.002*x2**2*x3 + 0.041*x2**2 - 0.021*x2*x3 + 0.55*x2 - 0.003*x3**3 + 0.038*x3**2 + 0.623*x3 + 0.066) best training time: 0.6618139743804932
INFO:root:Target formula: mom*sqrt(Bx**2+By**2+Bz**2)
INFO:root:Estimated formula: (0.004*x0**3 + 0.001*x0**2*x2 + 0.019*x0**2 + 0.748*x0*x1**2 + 0.194*x0*x1*x2 + 0.268*x0*x1*x3 + 0.004*x0*x1 + 0.754*x0*x2**2 + 0.307*x0*x2*x3 + 0.777*x0*x3**2 + 0.001*x1**2*x2 + 0.004*x1**2*x3 + 0.001*x1*x3 + 0.002*x2**2*x3 + 0.003*x3**3 + 0.001*x3**2)/(-0.001*x0**3 + 0.001*x0**2*x3 + 0.009*x0**2 - 0.007*x0*x1 - 0.003*x0*x2 - 0.011*x0*x3 + 0.008*x0 - 0.002*x1**3 - 0.002*x1**2*x3 + 0.043*x1**2 + 0.001*x1*x2**2 + 0.006*x1*x2*x3 - 0.047*x1*x2 + 0.001*x1*x3**2 - 0.031*x1*x3 + 0.544*x1 - 0.002*x2**3 - 0.002*x2**2*x3 + 0.041*x2**2 - 0.021*x2*x3 + 0.55*x2 - 0.003*x3**3 + 0.038*x3**2 + 0.623*x3 + 0.066), Training time: 8.6303551197052
INFO:root:Relative L2 distance train: 0.0010506581824987885, validation: 0.0012990700086835873
INFO:root:R squared validation: 0.9999982505069732
INFO:root:Number of active coefficients: 70
INFO:root:Number of evaluations in total: 11364
INFO:root:##########2 out of 3 datasets: feynman_III_12_43##########
INFO:root:Time: 20240522_165603
INFO:root:Feature shape: (100000, 2), target shape: (100000,)
INFO:root:###1 out of 1 Hyperparameter combinations ###
INFO:root:Training parameters: {'normalization': False, 'time_limit': 48, 'evaluations_limit': 1000000, 'max_dataset_length': 500, 'model': 'ParFamTorch', 'target_noise': 0.0, 'feature_noise': 0.0, 'seed': 12345, 'accuracy': 0.0001, 'maxiter1': 10, 'maxiter2': 0, 'optimizer': 'basinhopping', 'pruning_iterations': 1, 'pruning_cut_off': 0.01, 'classifier': None, 'local_minimizer': 'BFGS', 'maxiter_per_dim_local_minimizer': 100, 'lambda_1': 0.001, 'repetitions': 1, 'parallel': False, 'n_processes': 4, 'lambda_1_cut': 0, 'lambda_1_piecewise': 0, 'device': 'cpu', 'iterative_finetuning': True, 'max_n_active_parameters': 10, 'lambda_1_finetuning': 1e-05, 'path_pretrained': 'Flexible dimension/full_19_big_training_sets/20240427_070711_5M/Datetime_20240427_070717_Loss_training_set_size_797545_batch_size_341_hidden_dim_256.pt', 'topk_predictions': 10, 'enforce_function_iterate': 'False', 'procs': 6, 'populations': 6, 'population_size': 50, 'ncycles_per_iteration': 500, 'max_size': 50, 'max_depth': 10, 'iterations_udsr': 50000, 'accuracy_udsr': 1e-08, 'aif_nn_epochs': 60, 'bf_try_time': 4, 'bf_ops_file_type': '10ops', 'polyfit_deg': 3, 'max_input_points': 200, 'max_number_bags': 100, 'n_trees_to_refine': 100}
INFO:root:Sequential computation
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 4, 'degree_output_denominator': 0, 'degree_input_denominator': 0, 'function_names': [], 'width': 1, 'functions': [], 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 13
INFO:root:Number parameters active: 13
INFO:root:Number of evaluations: 719
INFO:root:Relative l2 distance train: 7.332147649311816e-08
INFO:root:Relative l2 distance validation: 7.622648779363448e-08
INFO:root:Training time: 0.26291632652282715
INFO:root:Cumulative training time: 0.370711088180542
INFO:root:Cumulative number of evaluations: 719
INFO:root:New best relative l2 distance validation: 7.622648779363448e-08
INFO:root:Terminate proccess, wanted accuracy 0.0001 and number of active parameters 1 / 10 was reached
INFO:root:Time for multiprocessing in total: 0.37134766578674316
INFO:root:Finetuning with this cut off would not change anything.
INFO:root:Finetuning with this cut off would not change anything.
INFO:root:Finetuning with this cut off would not change anything.
INFO:root:Finetuning with this cut off would not change anything.
INFO:root:Finetuning with this cut off would not change anything.
INFO:root:Finetuning with this cut off would not change anything.
INFO:root:Finetuning with this cut off would not change anything.
INFO:root:Best distance (train, val, test): (tensor(7.3321e-08, dtype=torch.float64), tensor(7.6226e-08, dtype=torch.float64), tensor(7.7383e-08, dtype=torch.float64))
INFO:root:Best formula: 0.159*x0*x1 best training time: 0.26291632652282715
INFO:root:Target formula: n*(h/(2*pi))
INFO:root:Estimated formula: 0.159*x0*x1, Training time: 0.37134766578674316
INFO:root:Relative L2 distance train: 7.332147649311816e-08, validation: 7.622648779363448e-08
INFO:root:R squared validation: 0.9999999999999942
INFO:root:Number of active coefficients: 13
INFO:root:Number of evaluations in total: 719
INFO:root:##########3 out of 3 datasets: feynman_III_13_18##########
INFO:root:Time: 20240522_165604
INFO:root:Feature shape: (100000, 4), target shape: (100000,)
INFO:root:###1 out of 1 Hyperparameter combinations ###
INFO:root:Training parameters: {'normalization': False, 'time_limit': 48, 'evaluations_limit': 1000000, 'max_dataset_length': 500, 'model': 'ParFamTorch', 'target_noise': 0.0, 'feature_noise': 0.0, 'seed': 12345, 'accuracy': 0.0001, 'maxiter1': 10, 'maxiter2': 0, 'optimizer': 'basinhopping', 'pruning_iterations': 1, 'pruning_cut_off': 0.01, 'classifier': None, 'local_minimizer': 'BFGS', 'maxiter_per_dim_local_minimizer': 100, 'lambda_1': 0.001, 'repetitions': 1, 'parallel': False, 'n_processes': 4, 'lambda_1_cut': 0, 'lambda_1_piecewise': 0, 'device': 'cpu', 'iterative_finetuning': True, 'max_n_active_parameters': 10, 'lambda_1_finetuning': 1e-05, 'path_pretrained': 'Flexible dimension/full_19_big_training_sets/20240427_070711_5M/Datetime_20240427_070717_Loss_training_set_size_797545_batch_size_341_hidden_dim_256.pt', 'topk_predictions': 10, 'enforce_function_iterate': 'False', 'procs': 6, 'populations': 6, 'population_size': 50, 'ncycles_per_iteration': 500, 'max_size': 50, 'max_depth': 10, 'iterations_udsr': 50000, 'accuracy_udsr': 1e-08, 'aif_nn_epochs': 60, 'bf_try_time': 4, 'bf_ops_file_type': '10ops', 'polyfit_deg': 3, 'max_input_points': 200, 'max_number_bags': 100, 'n_trees_to_refine': 100}
INFO:root:Sequential computation
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 4, 'degree_output_denominator': 0, 'degree_input_denominator': 0, 'function_names': [], 'width': 1, 'functions': [], 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 66
INFO:root:Number parameters active: 66
INFO:root:Number of evaluations: 438
INFO:root:Relative l2 distance train: 0.09689710243778894
INFO:root:Relative l2 distance validation: 0.12511716852659835
INFO:root:Training time: 0.27407240867614746
INFO:root:Cumulative training time: 0.4117875099182129
INFO:root:Cumulative number of evaluations: 438
INFO:root:New best relative l2 distance validation: 0.12511716852659835
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 1, 'degree_output_denominator': 1, 'degree_input_denominator': 0, 'functions': [], 'function_names': [], 'width': 1, 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 10
INFO:root:Number parameters active: 10
INFO:root:Number of evaluations: 484
INFO:root:Relative l2 distance train: 0.5118108614689058
INFO:root:Relative l2 distance validation: 26.837237650369126
INFO:root:Training time: 0.2089095115661621
INFO:root:Cumulative training time: 0.6860196590423584
INFO:root:Cumulative number of evaluations: 922
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 2, 'degree_output_denominator': 1, 'degree_input_denominator': 0, 'functions': [], 'function_names': [], 'width': 1, 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 20
INFO:root:Number parameters active: 20
INFO:root:Number of evaluations: 496
INFO:root:Relative l2 distance train: 0.8818668306015736
INFO:root:Relative l2 distance validation: 20.185533085844312
INFO:root:Training time: 0.24030566215515137
INFO:root:Cumulative training time: 0.9932229518890381
INFO:root:Cumulative number of evaluations: 1418
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 3, 'degree_output_denominator': 1, 'degree_input_denominator': 0, 'functions': [], 'function_names': [], 'width': 1, 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 40
INFO:root:Number parameters active: 40
INFO:root:Number of evaluations: 947
INFO:root:Relative l2 distance train: 0.0575417633016011
INFO:root:Relative l2 distance validation: 0.06995309332299725
INFO:root:Training time: 0.55257248878479
INFO:root:Cumulative training time: 1.6624281406402588
INFO:root:Cumulative number of evaluations: 2365
INFO:root:New best relative l2 distance validation: 0.06995309332299725
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 4, 'degree_output_denominator': 1, 'degree_input_denominator': 0, 'functions': [], 'function_names': [], 'width': 1, 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 71
INFO:root:Number parameters active: 71
INFO:root:Number of evaluations: 912
INFO:root:Relative l2 distance train: 0.00019102551597279788
INFO:root:Relative l2 distance validation: 0.0002524188951694758
INFO:root:Training time: 0.7028107643127441
INFO:root:Cumulative training time: 2.4550681114196777
INFO:root:Cumulative number of evaluations: 3277
INFO:root:New best relative l2 distance validation: 0.0002524188951694758
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 1, 'degree_output_denominator': 2, 'degree_input_denominator': 0, 'functions': [], 'function_names': [], 'width': 1, 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 20
INFO:root:Number parameters active: 20
INFO:root:Number of evaluations: 609
INFO:root:Relative l2 distance train: 1.2857781411251799
INFO:root:Relative l2 distance validation: 1.314629009376518
INFO:root:Training time: 0.2856295108795166
INFO:root:Cumulative training time: 2.8073630332946777
INFO:root:Cumulative number of evaluations: 3886
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 2, 'degree_output_denominator': 2, 'degree_input_denominator': 0, 'functions': [], 'function_names': [], 'width': 1, 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 30
INFO:root:Number parameters active: 30
INFO:root:Number of evaluations: 726
INFO:root:Relative l2 distance train: 0.33990096438946865
INFO:root:Relative l2 distance validation: 1.1688942188195908
INFO:root:Training time: 0.3782949447631836
INFO:root:Cumulative training time: 3.299478054046631
INFO:root:Cumulative number of evaluations: 4612
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 3, 'degree_output_denominator': 2, 'degree_input_denominator': 0, 'functions': [], 'function_names': [], 'width': 1, 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 50
INFO:root:Number parameters active: 50
INFO:root:Number of evaluations: 1125
INFO:root:Relative l2 distance train: 0.15751845139870127
INFO:root:Relative l2 distance validation: 3.377145215347576
INFO:root:Training time: 0.8304708003997803
INFO:root:Cumulative training time: 4.223008632659912
INFO:root:Cumulative number of evaluations: 5737
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 4, 'degree_output_denominator': 2, 'degree_input_denominator': 0, 'functions': [], 'function_names': [], 'width': 1, 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 81
INFO:root:Number parameters active: 81
INFO:root:Number of evaluations: 806
INFO:root:Relative l2 distance train: 0.007076990240331571
INFO:root:Relative l2 distance validation: 0.007995560558063351
INFO:root:Training time: 0.684340238571167
INFO:root:Cumulative training time: 5.00468111038208
INFO:root:Cumulative number of evaluations: 6543
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 1, 'degree_output_denominator': 3, 'degree_input_denominator': 0, 'functions': [], 'function_names': [], 'width': 1, 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 40
INFO:root:Number parameters active: 40
INFO:root:Number of evaluations: 717
INFO:root:Relative l2 distance train: 1.2486791194854958
INFO:root:Relative l2 distance validation: 1.3148837287042163
INFO:root:Training time: 0.4155240058898926
INFO:root:Cumulative training time: 5.496347427368164
INFO:root:Cumulative number of evaluations: 7260
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 2, 'degree_output_denominator': 3, 'degree_input_denominator': 0, 'functions': [], 'function_names': [], 'width': 1, 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 50
INFO:root:Number parameters active: 50
INFO:root:Number of evaluations: 759
INFO:root:Relative l2 distance train: 1.3169170582484218
INFO:root:Relative l2 distance validation: 1.3147840312396553
INFO:root:Training time: 0.555305004119873
INFO:root:Cumulative training time: 6.1738879680633545
INFO:root:Cumulative number of evaluations: 8019
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 3, 'degree_output_denominator': 3, 'degree_input_denominator': 0, 'functions': [], 'function_names': [], 'width': 1, 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 70
INFO:root:Number parameters active: 70
INFO:root:Number of evaluations: 1017
INFO:root:Relative l2 distance train: 0.21234637979242316
INFO:root:Relative l2 distance validation: 7.371611305498235
INFO:root:Training time: 0.728466272354126
INFO:root:Cumulative training time: 6.991649150848389
INFO:root:Cumulative number of evaluations: 9036
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 4, 'degree_output_denominator': 3, 'degree_input_denominator': 0, 'functions': [], 'function_names': [], 'width': 1, 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 101
INFO:root:Number parameters active: 101
INFO:root:Number of evaluations: 904
INFO:root:Relative l2 distance train: 0.007936226705587666
INFO:root:Relative l2 distance validation: 0.5175491237528478
INFO:root:Training time: 0.8390536308288574
INFO:root:Cumulative training time: 7.933392286300659
INFO:root:Cumulative number of evaluations: 9940
INFO:root:Time for multiprocessing in total: 7.937912702560425
INFO:root:Finetuning with this cut off would not change anything.
INFO:root:Finetuning with this cut off would not change anything.
INFO:root:Best distance (train, val, test): (tensor(0.0002, dtype=torch.float64), tensor(0.0003, dtype=torch.float64), tensor(0.0002, dtype=torch.float64))
INFO:root:Best formula: (-0.001*x0**3*x1 + 0.007*x0**3*x2 - 0.006*x0**3*x3 - 0.005*x0**3 + 0.01*x0**2*x1**2 + 0.009*x0**2*x1*x2 + 0.002*x0**2*x1*x3 + 0.008*x0**2*x1 + 0.004*x0**2*x2**2 - 0.01*x0**2*x2*x3 + 0.004*x0**2*x2 + 0.01*x0**2*x3**2 - 0.021*x0**2*x3 - 0.009*x0*x1**3 - 12.563*x0*x1**2*x2 - 0.009*x0*x1**2*x3 - 0.007*x0*x1**2 + 0.001*x0*x1*x2**2 - 0.003*x0*x1*x2*x3 - 0.005*x0*x1*x2 + 0.001*x0*x1*x3**2 + 0.012*x0*x1*x3 - 0.001*x0*x1 - 0.005*x0*x2**3 - 0.003*x0*x2**2*x3 - 0.009*x0*x2**2 - 0.001*x0*x2*x3**2 + 0.002*x0*x2*x3 + 0.006*x0*x2 + 0.007*x0*x3**3 - 0.014*x0*x3**2 - 0.004*x0*x3 + 0.019*x0 - 0.004*x1**3*x2 + 0.012*x1**3*x3 - 0.002*x1**3 - 0.012*x1**2*x2**2 - 0.006*x1**2*x2*x3 + 0.009*x1**2*x2 - 0.002*x1**2*x3**2 + 0.001*x1**2*x3 + 0.005*x1*x2**3 + 0.008*x1*x2**2*x3 - 0.007*x1*x2**2 + 0.014*x1*x2*x3**2 + 0.002*x1*x2*x3 - 0.011*x1*x2 - 0.012*x1*x3**3 - 0.005*x1*x3**2 + 0.01*x1*x3 - 0.008*x1 - 0.003*x2**3*x3 + 0.009*x2**3 + 0.012*x2**2*x3**2 + 0.003*x2**2*x3 - 0.002*x2**2 - 0.018*x2*x3**3 - 0.002*x2*x3**2 - 0.02*x2*x3 - 0.007*x2 + 0.036*x3**3 - 0.004*x3 - 0.007)/(0.001*x0 - 0.001*x1 - 1.0*x3) best training time: 0.7028107643127441
INFO:root:Target formula: 2*E_n*d**2*k/(h/(2*pi))
INFO:root:Estimated formula: (-0.001*x0**3*x1 + 0.007*x0**3*x2 - 0.006*x0**3*x3 - 0.005*x0**3 + 0.01*x0**2*x1**2 + 0.009*x0**2*x1*x2 + 0.002*x0**2*x1*x3 + 0.008*x0**2*x1 + 0.004*x0**2*x2**2 - 0.01*x0**2*x2*x3 + 0.004*x0**2*x2 + 0.01*x0**2*x3**2 - 0.021*x0**2*x3 - 0.009*x0*x1**3 - 12.563*x0*x1**2*x2 - 0.009*x0*x1**2*x3 - 0.007*x0*x1**2 + 0.001*x0*x1*x2**2 - 0.003*x0*x1*x2*x3 - 0.005*x0*x1*x2 + 0.001*x0*x1*x3**2 + 0.012*x0*x1*x3 - 0.001*x0*x1 - 0.005*x0*x2**3 - 0.003*x0*x2**2*x3 - 0.009*x0*x2**2 - 0.001*x0*x2*x3**2 + 0.002*x0*x2*x3 + 0.006*x0*x2 + 0.007*x0*x3**3 - 0.014*x0*x3**2 - 0.004*x0*x3 + 0.019*x0 - 0.004*x1**3*x2 + 0.012*x1**3*x3 - 0.002*x1**3 - 0.012*x1**2*x2**2 - 0.006*x1**2*x2*x3 + 0.009*x1**2*x2 - 0.002*x1**2*x3**2 + 0.001*x1**2*x3 + 0.005*x1*x2**3 + 0.008*x1*x2**2*x3 - 0.007*x1*x2**2 + 0.014*x1*x2*x3**2 + 0.002*x1*x2*x3 - 0.011*x1*x2 - 0.012*x1*x3**3 - 0.005*x1*x3**2 + 0.01*x1*x3 - 0.008*x1 - 0.003*x2**3*x3 + 0.009*x2**3 + 0.012*x2**2*x3**2 + 0.003*x2**2*x3 - 0.002*x2**2 - 0.018*x2*x3**3 - 0.002*x2*x3**2 - 0.02*x2*x3 - 0.007*x2 + 0.036*x3**3 - 0.004*x3 - 0.007)/(0.001*x0 - 0.001*x1 - 1.0*x3), Training time: 7.937912702560425
INFO:root:Relative L2 distance train: 0.00019102551597279788, validation: 0.0002524188951694758
INFO:root:R squared validation: 0.9999999388937078
INFO:root:Number of active coefficients: 71
INFO:root:Number of evaluations in total: 9940
INFO:root:Finished the experiment on 20240522_165616
