INFO:root:Starting the logger.
INFO:root:##########1 out of 3 datasets: feynman_III_10_19##########
INFO:root:Time: 20240522_170219
INFO:root:Feature shape: (100000, 4), target shape: (100000,)
INFO:root:###1 out of 1 Hyperparameter combinations ###
INFO:root:Training parameters: {'normalization': False, 'time_limit': 48, 'evaluations_limit': 1000000, 'max_dataset_length': 500, 'model': 'ParFamTorch', 'target_noise': 0.0, 'feature_noise': 0.0, 'seed': 12345, 'accuracy': 0.0001, 'maxiter1': 10, 'maxiter2': 0, 'optimizer': 'basinhopping', 'pruning_iterations': 1, 'pruning_cut_off': 0.01, 'classifier': None, 'local_minimizer': 'BFGS', 'maxiter_per_dim_local_minimizer': 100, 'lambda_1': 0.001, 'repetitions': 1, 'parallel': False, 'n_processes': 4, 'lambda_1_cut': 0, 'lambda_1_piecewise': 0, 'device': 'cpu', 'iterative_finetuning': True, 'max_n_active_parameters': 10, 'lambda_1_finetuning': 1e-05, 'path_pretrained': 'Flexible dimension/full_19_big_training_sets/20240427_070711_5M/Datetime_20240427_070717_Loss_training_set_size_797545_batch_size_341_hidden_dim_256.pt', 'topk_predictions': 10, 'enforce_function_iterate': 'False', 'procs': 6, 'populations': 6, 'population_size': 50, 'ncycles_per_iteration': 500, 'max_size': 50, 'max_depth': 10, 'iterations_udsr': 50000, 'accuracy_udsr': 1e-08, 'aif_nn_epochs': 60, 'bf_try_time': 4, 'bf_ops_file_type': '10ops', 'polyfit_deg': 3, 'max_input_points': 200, 'max_number_bags': 100, 'n_trees_to_refine': 100}
INFO:root:Sequential computation
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 4, 'degree_output_denominator': 0, 'degree_input_denominator': 0, 'function_names': [], 'width': 1, 'functions': [], 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 66
INFO:root:Number parameters active: 66
INFO:root:Number of evaluations: 508
INFO:root:Relative l2 distance train: 0.002652477111180142
INFO:root:Relative l2 distance validation: 0.0031935821064184035
INFO:root:Training time: 0.35102128982543945
INFO:root:Cumulative training time: 0.5021204948425293
INFO:root:Cumulative number of evaluations: 508
INFO:root:New best relative l2 distance validation: 0.0031935821064184035
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 1, 'degree_output_denominator': 1, 'degree_input_denominator': 0, 'functions': [], 'function_names': [], 'width': 1, 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 10
INFO:root:Number parameters active: 10
INFO:root:Number of evaluations: 634
INFO:root:Relative l2 distance train: 0.14574356022589297
INFO:root:Relative l2 distance validation: 0.1479343154193785
INFO:root:Training time: 0.2826378345489502
INFO:root:Cumulative training time: 0.8525419235229492
INFO:root:Cumulative number of evaluations: 1142
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 2, 'degree_output_denominator': 1, 'degree_input_denominator': 0, 'functions': [], 'function_names': [], 'width': 1, 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 20
INFO:root:Number parameters active: 20
INFO:root:Number of evaluations: 754
INFO:root:Relative l2 distance train: 0.030481919332802414
INFO:root:Relative l2 distance validation: 0.0355268861812568
INFO:root:Training time: 0.37323856353759766
INFO:root:Cumulative training time: 1.2949550151824951
INFO:root:Cumulative number of evaluations: 1896
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 3, 'degree_output_denominator': 1, 'degree_input_denominator': 0, 'functions': [], 'function_names': [], 'width': 1, 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 40
INFO:root:Number parameters active: 40
INFO:root:Number of evaluations: 511
INFO:root:Relative l2 distance train: 0.03348313845430784
INFO:root:Relative l2 distance validation: 0.718938945890217
INFO:root:Training time: 0.2924692630767822
INFO:root:Cumulative training time: 1.7058353424072266
INFO:root:Cumulative number of evaluations: 2407
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 4, 'degree_output_denominator': 1, 'degree_input_denominator': 0, 'functions': [], 'function_names': [], 'width': 1, 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 71
INFO:root:Number parameters active: 71
INFO:root:Number of evaluations: 739
INFO:root:Relative l2 distance train: 0.0012721672494371056
INFO:root:Relative l2 distance validation: 0.00162849679001568
INFO:root:Training time: 0.5632905960083008
INFO:root:Cumulative training time: 2.360077381134033
INFO:root:Cumulative number of evaluations: 3146
INFO:root:New best relative l2 distance validation: 0.00162849679001568
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 1, 'degree_output_denominator': 2, 'degree_input_denominator': 0, 'functions': [], 'function_names': [], 'width': 1, 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 20
INFO:root:Number parameters active: 20
INFO:root:Number of evaluations: 1054
INFO:root:Relative l2 distance train: 0.06272090184300783
INFO:root:Relative l2 distance validation: 0.06077145371337312
INFO:root:Training time: 0.5193352699279785
INFO:root:Cumulative training time: 2.952960729598999
INFO:root:Cumulative number of evaluations: 4200
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 2, 'degree_output_denominator': 2, 'degree_input_denominator': 0, 'functions': [], 'function_names': [], 'width': 1, 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 30
INFO:root:Number parameters active: 30
INFO:root:Number of evaluations: 626
INFO:root:Relative l2 distance train: 0.02228777284796418
INFO:root:Relative l2 distance validation: 0.025667329900855507
INFO:root:Training time: 0.3327491283416748
INFO:root:Cumulative training time: 3.3961594104766846
INFO:root:Cumulative number of evaluations: 4826
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 3, 'degree_output_denominator': 2, 'degree_input_denominator': 0, 'functions': [], 'function_names': [], 'width': 1, 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 50
INFO:root:Number parameters active: 50
INFO:root:Number of evaluations: 994
INFO:root:Relative l2 distance train: 0.02244320997029375
INFO:root:Relative l2 distance validation: 0.10335897028465303
INFO:root:Training time: 0.6359436511993408
INFO:root:Cumulative training time: 4.111194133758545
INFO:root:Cumulative number of evaluations: 5820
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 4, 'degree_output_denominator': 2, 'degree_input_denominator': 0, 'functions': [], 'function_names': [], 'width': 1, 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 81
INFO:root:Number parameters active: 81
INFO:root:Number of evaluations: 870
INFO:root:Relative l2 distance train: 0.003375662342806113
INFO:root:Relative l2 distance validation: 0.0206455626112893
INFO:root:Training time: 0.7064392566680908
INFO:root:Cumulative training time: 4.913843393325806
INFO:root:Cumulative number of evaluations: 6690
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 1, 'degree_output_denominator': 3, 'degree_input_denominator': 0, 'functions': [], 'function_names': [], 'width': 1, 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 40
INFO:root:Number parameters active: 40
INFO:root:Number of evaluations: 1147
INFO:root:Relative l2 distance train: 0.01814840624704922
INFO:root:Relative l2 distance validation: 0.023719489556914095
INFO:root:Training time: 0.6652431488037109
INFO:root:Cumulative training time: 5.695636987686157
INFO:root:Cumulative number of evaluations: 7837
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 2, 'degree_output_denominator': 3, 'degree_input_denominator': 0, 'functions': [], 'function_names': [], 'width': 1, 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 50
INFO:root:Number parameters active: 50
INFO:root:Number of evaluations: 1040
INFO:root:Relative l2 distance train: 0.07662944621885111
INFO:root:Relative l2 distance validation: 1.2392496907239885
INFO:root:Training time: 0.6540417671203613
INFO:root:Cumulative training time: 6.428873777389526
INFO:root:Cumulative number of evaluations: 8877
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 3, 'degree_output_denominator': 3, 'degree_input_denominator': 0, 'functions': [], 'function_names': [], 'width': 1, 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 70
INFO:root:Number parameters active: 70
INFO:root:Number of evaluations: 893
INFO:root:Relative l2 distance train: 0.005043397398577259
INFO:root:Relative l2 distance validation: 0.005899896477241099
INFO:root:Training time: 0.8560872077941895
INFO:root:Cumulative training time: 7.372112989425659
INFO:root:Cumulative number of evaluations: 9770
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 4, 'degree_output_denominator': 3, 'degree_input_denominator': 0, 'functions': [], 'function_names': [], 'width': 1, 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 101
INFO:root:Number parameters active: 101
INFO:root:Number of evaluations: 755
INFO:root:Relative l2 distance train: 0.001793538221061598
INFO:root:Relative l2 distance validation: 0.0021852897204513713
INFO:root:Training time: 0.8999946117401123
INFO:root:Cumulative training time: 8.451335668563843
INFO:root:Cumulative number of evaluations: 10525
INFO:root:Model parameters: {'degree_input_polynomials': 2, 'degree_input_denominator': 0, 'degree_output_polynomials': 2, 'degree_output_denominator': 0, 'function_names': ['sqrt'], 'functions': ['sqrt'], 'degree_output_polynomials_specific': [1], 'degree_output_polynomials_denominator_specific': [1], 'maximal_potence': 3, 'enforce_function': False}
INFO:root:Number parameters: 35
INFO:root:Number parameters active: 35
INFO:root:Number of evaluations: 343
INFO:root:Relative l2 distance train: 0.018080703698554985
INFO:root:Relative l2 distance validation: 0.020940552372073023
INFO:root:Training time: 0.3548252582550049
INFO:root:Cumulative training time: 8.89295482635498
INFO:root:Cumulative number of evaluations: 10868
INFO:root:Model parameters: {'degree_input_polynomials': 2, 'degree_input_denominator': 0, 'degree_output_polynomials': 2, 'degree_output_denominator': 1, 'function_names': ['sqrt'], 'functions': ['sqrt'], 'degree_output_polynomials_specific': [1], 'degree_output_polynomials_denominator_specific': [1], 'maximal_potence': 3, 'enforce_function': False}
INFO:root:Number parameters: 41
INFO:root:Number parameters active: 41
INFO:root:Number of evaluations: 906
INFO:root:Relative l2 distance train: 0.0038127573262069473
INFO:root:Relative l2 distance validation: 0.008375806923330077
INFO:root:Training time: 1.3830902576446533
INFO:root:Cumulative training time: 10.352230310440063
INFO:root:Cumulative number of evaluations: 11774
INFO:root:Model parameters: {'degree_input_polynomials': 2, 'degree_input_denominator': 0, 'degree_output_polynomials': 3, 'degree_output_denominator': 0, 'function_names': ['sqrt'], 'functions': ['sqrt'], 'degree_output_polynomials_specific': [1], 'degree_output_polynomials_denominator_specific': [1], 'maximal_potence': 3, 'enforce_function': False}
INFO:root:Number parameters: 65
INFO:root:Number parameters active: 65
INFO:root:Number of evaluations: 687
INFO:root:Relative l2 distance train: 0.004689220962790903
INFO:root:Relative l2 distance validation: 0.006521813897913371
INFO:root:Training time: 1.6587440967559814
INFO:root:Cumulative training time: 12.096876382827759
INFO:root:Cumulative number of evaluations: 12461
INFO:root:Model parameters: {'degree_input_polynomials': 2, 'degree_input_denominator': 2, 'degree_output_polynomials': 2, 'degree_output_denominator': 0, 'function_names': ['sqrt'], 'functions': ['sqrt'], 'degree_output_polynomials_specific': [1], 'degree_output_polynomials_denominator_specific': [1], 'maximal_potence': 3, 'enforce_function': False}
INFO:root:Number parameters: 50
INFO:root:Number parameters active: 50
INFO:root:Number of evaluations: 965
INFO:root:Relative l2 distance train: 0.01396174777221518
INFO:root:Relative l2 distance validation: 0.026327847484726007
INFO:root:Training time: 1.1337699890136719
INFO:root:Cumulative training time: 13.34700870513916
INFO:root:Cumulative number of evaluations: 13426
INFO:root:Model parameters: {'degree_input_polynomials': 2, 'degree_input_denominator': 1, 'degree_output_polynomials': 2, 'degree_output_denominator': 0, 'function_names': ['sqrt'], 'functions': ['sqrt'], 'degree_output_polynomials_specific': [1], 'degree_output_polynomials_denominator_specific': [1], 'maximal_potence': 3, 'enforce_function': False}
INFO:root:Number parameters: 40
INFO:root:Number parameters active: 40
INFO:root:Number of evaluations: 745
INFO:root:Relative l2 distance train: 0.018484312891908664
INFO:root:Relative l2 distance validation: 0.11372914977902426
INFO:root:Training time: 0.848289966583252
INFO:root:Cumulative training time: 14.268447399139404
INFO:root:Cumulative number of evaluations: 14171
INFO:root:Model parameters: {'degree_input_polynomials': 2, 'degree_input_denominator': 0, 'degree_output_polynomials': 4, 'degree_output_denominator': 0, 'function_names': ['sqrt'], 'functions': ['sqrt'], 'degree_output_polynomials_specific': [1], 'degree_output_polynomials_denominator_specific': [1], 'maximal_potence': 3, 'enforce_function': False}
INFO:root:Number parameters: 116
INFO:root:Number parameters active: 116
INFO:root:Number of evaluations: 722
INFO:root:Relative l2 distance train: 0.002589802370533329
INFO:root:Relative l2 distance validation: 0.0029834708582274177
INFO:root:Training time: 4.415817022323608
INFO:root:Cumulative training time: 18.798609733581543
INFO:root:Cumulative number of evaluations: 14893
INFO:root:Model parameters: {'degree_input_polynomials': 2, 'degree_input_denominator': 0, 'degree_output_polynomials': 2, 'degree_output_denominator': 2, 'function_names': ['sqrt'], 'functions': ['sqrt'], 'degree_output_polynomials_specific': [1], 'degree_output_polynomials_denominator_specific': [1], 'maximal_potence': 3, 'enforce_function': False}
INFO:root:Number parameters: 55
INFO:root:Number parameters active: 55
INFO:root:Number of evaluations: 729
INFO:root:Relative l2 distance train: 0.010825812608590744
INFO:root:Relative l2 distance validation: 0.013020243386663759
INFO:root:Training time: 1.3069584369659424
INFO:root:Cumulative training time: 20.233595848083496
INFO:root:Cumulative number of evaluations: 15622
INFO:root:Model parameters: {'degree_input_polynomials': 2, 'degree_input_denominator': 0, 'degree_output_polynomials': 1, 'degree_output_denominator': 0, 'function_names': ['sqrt'], 'functions': ['sqrt'], 'degree_output_polynomials_specific': [1], 'degree_output_polynomials_denominator_specific': [1], 'maximal_potence': 3, 'enforce_function': False}
INFO:root:Number parameters: 21
INFO:root:Number parameters active: 21
INFO:root:Number of evaluations: 643
INFO:root:Relative l2 distance train: 0.06051023891043595
INFO:root:Relative l2 distance validation: 0.07165356370233687
INFO:root:Training time: 0.3565239906311035
INFO:root:Cumulative training time: 20.65802788734436
INFO:root:Cumulative number of evaluations: 16265
INFO:root:Model parameters: {'degree_input_polynomials': 1, 'degree_input_denominator': 0, 'degree_output_polynomials': 2, 'degree_output_denominator': 0, 'function_names': ['sqrt'], 'functions': ['sqrt'], 'degree_output_polynomials_specific': [1], 'degree_output_polynomials_denominator_specific': [1], 'maximal_potence': 3, 'enforce_function': False}
INFO:root:Number parameters: 25
INFO:root:Number parameters active: 25
INFO:root:Number of evaluations: 457
INFO:root:Relative l2 distance train: 0.031831323661218235
INFO:root:Relative l2 distance validation: 0.03558141308159723
INFO:root:Training time: 0.4717085361480713
INFO:root:Cumulative training time: 21.200628757476807
INFO:root:Cumulative number of evaluations: 16722
INFO:root:Model parameters: {'degree_input_polynomials': 2, 'degree_input_denominator': 0, 'degree_output_polynomials': 3, 'degree_output_denominator': 1, 'function_names': ['sqrt'], 'functions': ['sqrt'], 'degree_output_polynomials_specific': [1], 'degree_output_polynomials_denominator_specific': [1], 'maximal_potence': 3, 'enforce_function': False}
INFO:root:Number parameters: 71
INFO:root:Number parameters active: 71
INFO:root:Number of evaluations: 913
INFO:root:Relative l2 distance train: 0.0009245790842842806
INFO:root:Relative l2 distance validation: 0.0012291257839057745
INFO:root:Training time: 2.434296131134033
INFO:root:Cumulative training time: 23.7622013092041
INFO:root:Cumulative number of evaluations: 17635
INFO:root:New best relative l2 distance validation: 0.0012291257839057745
INFO:root:Time for multiprocessing in total: 23.770308017730713
INFO:root:Finetuning with this cut off would not change anything.
INFO:root:Finetuning with this cut off would not change anything.
INFO:root:Best distance (train, val, test): (tensor(0.0009, dtype=torch.float64), tensor(0.0012, dtype=torch.float64), tensor(0.0012, dtype=torch.float64))
INFO:root:Best formula: (0.005*x0**3 + 0.073*x0**2*x1 + 0.096*x0**2*x2 + 0.094*x0**2*x3 - 0.01*x0**2*sqrt(Abs(0.336*x0**2 + 0.07*x0*x1 + 0.07*x0*x2 - 0.018*x0*x3 + 0.016*x1**2 - 0.003*x1*x2 - 0.018*x1*x3 - 0.002*x1 + 0.015*x2**2 - 0.014*x2*x3 + 0.013*x3**2 - 0.002*x3)) - 0.036*x0*x1**2 + 0.003*x0*x1*x2 - 0.012*x0*x1*x3 - 0.139*x0*x1*sqrt(Abs(0.336*x0**2 + 0.07*x0*x1 + 0.07*x0*x2 - 0.018*x0*x3 + 0.016*x1**2 - 0.003*x1*x2 - 0.018*x1*x3 - 0.002*x1 + 0.015*x2**2 - 0.014*x2*x3 + 0.013*x3**2 - 0.002*x3)) - 0.052*x0*x2**2 - 0.013*x0*x2*x3 - 0.178*x0*x2*sqrt(Abs(0.336*x0**2 + 0.07*x0*x1 + 0.07*x0*x2 - 0.018*x0*x3 + 0.016*x1**2 - 0.003*x1*x2 - 0.018*x1*x3 - 0.002*x1 + 0.015*x2**2 - 0.014*x2*x3 + 0.013*x3**2 - 0.002*x3)) - 0.06*x0*x3**2 - 0.177*x0*x3*sqrt(Abs(0.336*x0**2 + 0.07*x0*x1 + 0.07*x0*x2 - 0.018*x0*x3 + 0.016*x1**2 - 0.003*x1*x2 - 0.018*x1*x3 - 0.002*x1 + 0.015*x2**2 - 0.014*x2*x3 + 0.013*x3**2 - 0.002*x3)) - 0.001*x0*x3 + 0.002*x0*sqrt(Abs(0.336*x0**2 + 0.07*x0*x1 + 0.07*x0*x2 - 0.018*x0*x3 + 0.016*x1**2 - 0.003*x1*x2 - 0.018*x1*x3 - 0.002*x1 + 0.015*x2**2 - 0.014*x2*x3 + 0.013*x3**2 - 0.002*x3)) + 0.003*x1**3 + 0.002*x1**2*x2 - 0.002*x1**2*x3 - 0.042*x1**2*sqrt(Abs(0.336*x0**2 + 0.07*x0*x1 + 0.07*x0*x2 - 0.018*x0*x3 + 0.016*x1**2 - 0.003*x1*x2 - 0.018*x1*x3 - 0.002*x1 + 0.015*x2**2 - 0.014*x2*x3 + 0.013*x3**2 - 0.002*x3)) + 0.002*x1*x2**2 + 0.005*x1*x2*x3 - 0.011*x1*x2*sqrt(Abs(0.336*x0**2 + 0.07*x0*x1 + 0.07*x0*x2 - 0.018*x0*x3 + 0.016*x1**2 - 0.003*x1*x2 - 0.018*x1*x3 - 0.002*x1 + 0.015*x2**2 - 0.014*x2*x3 + 0.013*x3**2 - 0.002*x3)) + 0.004*x1*x3**2 - 0.009*x1*x3*sqrt(Abs(0.336*x0**2 + 0.07*x0*x1 + 0.07*x0*x2 - 0.018*x0*x3 + 0.016*x1**2 - 0.003*x1*x2 - 0.018*x1*x3 - 0.002*x1 + 0.015*x2**2 - 0.014*x2*x3 + 0.013*x3**2 - 0.002*x3)) + 0.001*x1*x3 - 0.001*x2**2*x3 - 0.01*x2**2*sqrt(Abs(0.336*x0**2 + 0.07*x0*x1 + 0.07*x0*x2 - 0.018*x0*x3 + 0.016*x1**2 - 0.003*x1*x2 - 0.018*x1*x3 - 0.002*x1 + 0.015*x2**2 - 0.014*x2*x3 + 0.013*x3**2 - 0.002*x3)) + 0.003*x2*x3**2 - 0.011*x2*x3*sqrt(Abs(0.336*x0**2 + 0.07*x0*x1 + 0.07*x0*x2 - 0.018*x0*x3 + 0.016*x1**2 - 0.003*x1*x2 - 0.018*x1*x3 - 0.002*x1 + 0.015*x2**2 - 0.014*x2*x3 + 0.013*x3**2 - 0.002*x3)) + 0.001*x2*x3 - 0.003*x3**3 - 0.027*x3**2*sqrt(Abs(0.336*x0**2 + 0.07*x0*x1 + 0.07*x0*x2 - 0.018*x0*x3 + 0.016*x1**2 - 0.003*x1*x2 - 0.018*x1*x3 - 0.002*x1 + 0.015*x2**2 - 0.014*x2*x3 + 0.013*x3**2 - 0.002*x3)))/(0.49*x0 - 0.001*x2 - 0.074*x3 - 0.869*sqrt(Abs(0.336*x0**2 + 0.07*x0*x1 + 0.07*x0*x2 - 0.018*x0*x3 + 0.016*x1**2 - 0.003*x1*x2 - 0.018*x1*x3 - 0.002*x1 + 0.015*x2**2 - 0.014*x2*x3 + 0.013*x3**2 - 0.002*x3)) + 0.001) best training time: 2.434296131134033
INFO:root:Target formula: mom*sqrt(Bx**2+By**2+Bz**2)
INFO:root:Estimated formula: (0.005*x0**3 + 0.073*x0**2*x1 + 0.096*x0**2*x2 + 0.094*x0**2*x3 - 0.01*x0**2*sqrt(Abs(0.336*x0**2 + 0.07*x0*x1 + 0.07*x0*x2 - 0.018*x0*x3 + 0.016*x1**2 - 0.003*x1*x2 - 0.018*x1*x3 - 0.002*x1 + 0.015*x2**2 - 0.014*x2*x3 + 0.013*x3**2 - 0.002*x3)) - 0.036*x0*x1**2 + 0.003*x0*x1*x2 - 0.012*x0*x1*x3 - 0.139*x0*x1*sqrt(Abs(0.336*x0**2 + 0.07*x0*x1 + 0.07*x0*x2 - 0.018*x0*x3 + 0.016*x1**2 - 0.003*x1*x2 - 0.018*x1*x3 - 0.002*x1 + 0.015*x2**2 - 0.014*x2*x3 + 0.013*x3**2 - 0.002*x3)) - 0.052*x0*x2**2 - 0.013*x0*x2*x3 - 0.178*x0*x2*sqrt(Abs(0.336*x0**2 + 0.07*x0*x1 + 0.07*x0*x2 - 0.018*x0*x3 + 0.016*x1**2 - 0.003*x1*x2 - 0.018*x1*x3 - 0.002*x1 + 0.015*x2**2 - 0.014*x2*x3 + 0.013*x3**2 - 0.002*x3)) - 0.06*x0*x3**2 - 0.177*x0*x3*sqrt(Abs(0.336*x0**2 + 0.07*x0*x1 + 0.07*x0*x2 - 0.018*x0*x3 + 0.016*x1**2 - 0.003*x1*x2 - 0.018*x1*x3 - 0.002*x1 + 0.015*x2**2 - 0.014*x2*x3 + 0.013*x3**2 - 0.002*x3)) - 0.001*x0*x3 + 0.002*x0*sqrt(Abs(0.336*x0**2 + 0.07*x0*x1 + 0.07*x0*x2 - 0.018*x0*x3 + 0.016*x1**2 - 0.003*x1*x2 - 0.018*x1*x3 - 0.002*x1 + 0.015*x2**2 - 0.014*x2*x3 + 0.013*x3**2 - 0.002*x3)) + 0.003*x1**3 + 0.002*x1**2*x2 - 0.002*x1**2*x3 - 0.042*x1**2*sqrt(Abs(0.336*x0**2 + 0.07*x0*x1 + 0.07*x0*x2 - 0.018*x0*x3 + 0.016*x1**2 - 0.003*x1*x2 - 0.018*x1*x3 - 0.002*x1 + 0.015*x2**2 - 0.014*x2*x3 + 0.013*x3**2 - 0.002*x3)) + 0.002*x1*x2**2 + 0.005*x1*x2*x3 - 0.011*x1*x2*sqrt(Abs(0.336*x0**2 + 0.07*x0*x1 + 0.07*x0*x2 - 0.018*x0*x3 + 0.016*x1**2 - 0.003*x1*x2 - 0.018*x1*x3 - 0.002*x1 + 0.015*x2**2 - 0.014*x2*x3 + 0.013*x3**2 - 0.002*x3)) + 0.004*x1*x3**2 - 0.009*x1*x3*sqrt(Abs(0.336*x0**2 + 0.07*x0*x1 + 0.07*x0*x2 - 0.018*x0*x3 + 0.016*x1**2 - 0.003*x1*x2 - 0.018*x1*x3 - 0.002*x1 + 0.015*x2**2 - 0.014*x2*x3 + 0.013*x3**2 - 0.002*x3)) + 0.001*x1*x3 - 0.001*x2**2*x3 - 0.01*x2**2*sqrt(Abs(0.336*x0**2 + 0.07*x0*x1 + 0.07*x0*x2 - 0.018*x0*x3 + 0.016*x1**2 - 0.003*x1*x2 - 0.018*x1*x3 - 0.002*x1 + 0.015*x2**2 - 0.014*x2*x3 + 0.013*x3**2 - 0.002*x3)) + 0.003*x2*x3**2 - 0.011*x2*x3*sqrt(Abs(0.336*x0**2 + 0.07*x0*x1 + 0.07*x0*x2 - 0.018*x0*x3 + 0.016*x1**2 - 0.003*x1*x2 - 0.018*x1*x3 - 0.002*x1 + 0.015*x2**2 - 0.014*x2*x3 + 0.013*x3**2 - 0.002*x3)) + 0.001*x2*x3 - 0.003*x3**3 - 0.027*x3**2*sqrt(Abs(0.336*x0**2 + 0.07*x0*x1 + 0.07*x0*x2 - 0.018*x0*x3 + 0.016*x1**2 - 0.003*x1*x2 - 0.018*x1*x3 - 0.002*x1 + 0.015*x2**2 - 0.014*x2*x3 + 0.013*x3**2 - 0.002*x3)))/(0.49*x0 - 0.001*x2 - 0.074*x3 - 0.869*sqrt(Abs(0.336*x0**2 + 0.07*x0*x1 + 0.07*x0*x2 - 0.018*x0*x3 + 0.016*x1**2 - 0.003*x1*x2 - 0.018*x1*x3 - 0.002*x1 + 0.015*x2**2 - 0.014*x2*x3 + 0.013*x3**2 - 0.002*x3)) + 0.001), Training time: 23.770308017730713
INFO:root:Relative L2 distance train: 0.0009245790842842806, validation: 0.0012291257839057745
INFO:root:R squared validation: 0.9999985594858366
INFO:root:Number of active coefficients: 71
INFO:root:Number of evaluations in total: 17635
INFO:root:##########2 out of 3 datasets: feynman_III_12_43##########
INFO:root:Time: 20240522_170332
INFO:root:Feature shape: (100000, 2), target shape: (100000,)
INFO:root:###1 out of 1 Hyperparameter combinations ###
INFO:root:Training parameters: {'normalization': False, 'time_limit': 48, 'evaluations_limit': 1000000, 'max_dataset_length': 500, 'model': 'ParFamTorch', 'target_noise': 0.0, 'feature_noise': 0.0, 'seed': 12345, 'accuracy': 0.0001, 'maxiter1': 10, 'maxiter2': 0, 'optimizer': 'basinhopping', 'pruning_iterations': 1, 'pruning_cut_off': 0.01, 'classifier': None, 'local_minimizer': 'BFGS', 'maxiter_per_dim_local_minimizer': 100, 'lambda_1': 0.001, 'repetitions': 1, 'parallel': False, 'n_processes': 4, 'lambda_1_cut': 0, 'lambda_1_piecewise': 0, 'device': 'cpu', 'iterative_finetuning': True, 'max_n_active_parameters': 10, 'lambda_1_finetuning': 1e-05, 'path_pretrained': 'Flexible dimension/full_19_big_training_sets/20240427_070711_5M/Datetime_20240427_070717_Loss_training_set_size_797545_batch_size_341_hidden_dim_256.pt', 'topk_predictions': 10, 'enforce_function_iterate': 'False', 'procs': 6, 'populations': 6, 'population_size': 50, 'ncycles_per_iteration': 500, 'max_size': 50, 'max_depth': 10, 'iterations_udsr': 50000, 'accuracy_udsr': 1e-08, 'aif_nn_epochs': 60, 'bf_try_time': 4, 'bf_ops_file_type': '10ops', 'polyfit_deg': 3, 'max_input_points': 200, 'max_number_bags': 100, 'n_trees_to_refine': 100}
INFO:root:Sequential computation
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 4, 'degree_output_denominator': 0, 'degree_input_denominator': 0, 'function_names': [], 'width': 1, 'functions': [], 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 13
INFO:root:Number parameters active: 13
INFO:root:Number of evaluations: 616
INFO:root:Relative l2 distance train: 7.503041575846358e-08
INFO:root:Relative l2 distance validation: 7.622648779479585e-08
INFO:root:Training time: 0.2223036289215088
INFO:root:Cumulative training time: 0.2891731262207031
INFO:root:Cumulative number of evaluations: 616
INFO:root:New best relative l2 distance validation: 7.622648779479585e-08
INFO:root:Terminate proccess, wanted accuracy 0.0001 and number of active parameters 1 / 10 was reached
INFO:root:Time for multiprocessing in total: 0.29013776779174805
INFO:root:Finetuning with this cut off would not change anything.
INFO:root:Finetuning with this cut off would not change anything.
INFO:root:Finetuning with this cut off would not change anything.
INFO:root:Finetuning with this cut off would not change anything.
INFO:root:Finetuning with this cut off would not change anything.
INFO:root:Finetuning with this cut off would not change anything.
INFO:root:Finetuning with this cut off would not change anything.
INFO:root:Best distance (train, val, test): (tensor(7.5030e-08, dtype=torch.float64), tensor(7.6226e-08, dtype=torch.float64), tensor(7.7383e-08, dtype=torch.float64))
INFO:root:Best formula: 0.159*x0*x1 best training time: 0.2223036289215088
INFO:root:Target formula: n*(h/(2*pi))
INFO:root:Estimated formula: 0.159*x0*x1, Training time: 0.29013776779174805
INFO:root:Relative L2 distance train: 7.503041575846358e-08, validation: 7.622648779479585e-08
INFO:root:R squared validation: 0.9999999999999941
INFO:root:Number of active coefficients: 13
INFO:root:Number of evaluations in total: 616
INFO:root:##########3 out of 3 datasets: feynman_III_13_18##########
INFO:root:Time: 20240522_170333
INFO:root:Feature shape: (100000, 4), target shape: (100000,)
INFO:root:###1 out of 1 Hyperparameter combinations ###
INFO:root:Training parameters: {'normalization': False, 'time_limit': 48, 'evaluations_limit': 1000000, 'max_dataset_length': 500, 'model': 'ParFamTorch', 'target_noise': 0.0, 'feature_noise': 0.0, 'seed': 12345, 'accuracy': 0.0001, 'maxiter1': 10, 'maxiter2': 0, 'optimizer': 'basinhopping', 'pruning_iterations': 1, 'pruning_cut_off': 0.01, 'classifier': None, 'local_minimizer': 'BFGS', 'maxiter_per_dim_local_minimizer': 100, 'lambda_1': 0.001, 'repetitions': 1, 'parallel': False, 'n_processes': 4, 'lambda_1_cut': 0, 'lambda_1_piecewise': 0, 'device': 'cpu', 'iterative_finetuning': True, 'max_n_active_parameters': 10, 'lambda_1_finetuning': 1e-05, 'path_pretrained': 'Flexible dimension/full_19_big_training_sets/20240427_070711_5M/Datetime_20240427_070717_Loss_training_set_size_797545_batch_size_341_hidden_dim_256.pt', 'topk_predictions': 10, 'enforce_function_iterate': 'False', 'procs': 6, 'populations': 6, 'population_size': 50, 'ncycles_per_iteration': 500, 'max_size': 50, 'max_depth': 10, 'iterations_udsr': 50000, 'accuracy_udsr': 1e-08, 'aif_nn_epochs': 60, 'bf_try_time': 4, 'bf_ops_file_type': '10ops', 'polyfit_deg': 3, 'max_input_points': 200, 'max_number_bags': 100, 'n_trees_to_refine': 100}
INFO:root:Sequential computation
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 4, 'degree_output_denominator': 0, 'degree_input_denominator': 0, 'function_names': [], 'width': 1, 'functions': [], 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 66
INFO:root:Number parameters active: 66
INFO:root:Number of evaluations: 622
INFO:root:Relative l2 distance train: 0.09974328417691106
INFO:root:Relative l2 distance validation: 0.1110246236744309
INFO:root:Training time: 0.38770294189453125
INFO:root:Cumulative training time: 0.4774644374847412
INFO:root:Cumulative number of evaluations: 622
INFO:root:New best relative l2 distance validation: 0.1110246236744309
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 1, 'degree_output_denominator': 1, 'degree_input_denominator': 0, 'functions': [], 'function_names': [], 'width': 1, 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 10
INFO:root:Number parameters active: 10
INFO:root:Number of evaluations: 422
INFO:root:Relative l2 distance train: 1.3210562128449366
INFO:root:Relative l2 distance validation: 1.416866130865759
INFO:root:Training time: 0.24642229080200195
INFO:root:Cumulative training time: 0.8214778900146484
INFO:root:Cumulative number of evaluations: 1044
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 2, 'degree_output_denominator': 1, 'degree_input_denominator': 0, 'functions': [], 'function_names': [], 'width': 1, 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 20
INFO:root:Number parameters active: 20
INFO:root:Number of evaluations: 482
INFO:root:Relative l2 distance train: 0.7111090039591609
INFO:root:Relative l2 distance validation: 5.663681586598479
INFO:root:Training time: 0.24894118309020996
INFO:root:Cumulative training time: 1.1831307411193848
INFO:root:Cumulative number of evaluations: 1526
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 3, 'degree_output_denominator': 1, 'degree_input_denominator': 0, 'functions': [], 'function_names': [], 'width': 1, 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 40
INFO:root:Number parameters active: 40
INFO:root:Number of evaluations: 752
INFO:root:Relative l2 distance train: 0.050642109793256423
INFO:root:Relative l2 distance validation: 0.07431966286800208
INFO:root:Training time: 0.4396061897277832
INFO:root:Cumulative training time: 1.7061686515808105
INFO:root:Cumulative number of evaluations: 2278
INFO:root:New best relative l2 distance validation: 0.07431966286800208
INFO:root:Model parameters: {'degree_input_polynomials': 0, 'degree_output_polynomials': 4, 'degree_output_denominator': 1, 'degree_input_denominator': 0, 'functions': [], 'function_names': [], 'width': 1, 'degree_output_polynomials_specific': None, 'degree_output_polynomials_denominator_specific': None, 'enforce_function': False, 'maximal_potence': 3}
INFO:root:Number parameters: 71
INFO:root:Number parameters active: 71
INFO:root:Number of evaluations: 869
INFO:root:Relative l2 distance train: 1.0130947572308868e-07
INFO:root:Relative l2 distance validation: 1.0215599887967799e-07
INFO:root:Training time: 0.6902906894683838
INFO:root:Cumulative training time: 2.488072156906128
INFO:root:Cumulative number of evaluations: 3147
INFO:root:New best relative l2 distance validation: 1.0215599887967799e-07
INFO:root:Terminate proccess, wanted accuracy 0.0001 and number of active parameters 2 / 10 was reached
INFO:root:Time for multiprocessing in total: 2.4910991191864014
INFO:root:Finetuning with this cut off would not change anything.
INFO:root:Finetuning with this cut off would not change anything.
INFO:root:Finetuning with this cut off would not change anything.
INFO:root:Finetuning with this cut off would not change anything.
INFO:root:Finetuning with this cut off would not change anything.
INFO:root:Finetuning with this cut off would not change anything.
INFO:root:Finetuning with this cut off would not change anything.
INFO:root:Best distance (train, val, test): (tensor(1.0131e-07, dtype=torch.float64), tensor(1.0216e-07, dtype=torch.float64), tensor(1.0228e-07, dtype=torch.float64))
INFO:root:Best formula: 12.566*x0*x1**2*x2/x3 best training time: 0.6902906894683838
INFO:root:Target formula: 2*E_n*d**2*k/(h/(2*pi))
INFO:root:Estimated formula: 12.566*x0*x1**2*x2/x3, Training time: 2.4910991191864014
INFO:root:Relative L2 distance train: 1.0130947572308868e-07, validation: 1.0215599887967799e-07
INFO:root:R squared validation: 0.9999999999999897
INFO:root:Number of active coefficients: 71
INFO:root:Number of evaluations in total: 3147
INFO:root:Finished the experiment on 20240522_170336
